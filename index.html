<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üëÅ NIGHTMARE FACTORY ‚Äî YouTube Horror Automation</title>
<link href="https://fonts.googleapis.com/css2?family=Creepster&family=Special+Elite&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
  :root {
    --blood: #8b0000;
    --crimson: #dc143c;
    --ember: #ff4500;
    --ash: #1a1a1a;
    --bone: #e8e0d0;
    --fog: #2a2a2a;
    --ghost: #444;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: #0a0a0a;
    color: var(--bone);
    font-family: 'Special Elite', cursive;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Animated background */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background: 
      radial-gradient(ellipse at 20% 50%, rgba(139,0,0,0.08) 0%, transparent 60%),
      radial-gradient(ellipse at 80% 20%, rgba(220,20,60,0.05) 0%, transparent 50%),
      radial-gradient(ellipse at 50% 80%, rgba(255,69,0,0.04) 0%, transparent 50%);
    pointer-events: none;
    z-index: 0;
    animation: breathe 8s ease-in-out infinite;
  }

  @keyframes breathe {
    0%, 100% { opacity: 0.6; }
    50% { opacity: 1; }
  }

  .noise {
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 0;
    opacity: 0.4;
  }

  .container {
    position: relative;
    z-index: 1;
    max-width: 960px;
    margin: 0 auto;
    padding: 20px;
  }

  /* HEADER */
  header {
    text-align: center;
    padding: 40px 0 30px;
    position: relative;
  }

  .skull { font-size: 2rem; animation: flicker 3s infinite; display: block; margin-bottom: 10px; }

  @keyframes flicker {
    0%, 95%, 100% { opacity: 1; }
    96% { opacity: 0.3; }
    97% { opacity: 1; }
    98% { opacity: 0.1; }
    99% { opacity: 0.8; }
  }

  h1 {
    font-family: 'Creepster', cursive;
    font-size: clamp(2rem, 6vw, 3.5rem);
    color: var(--crimson);
    text-shadow: 0 0 30px rgba(220,20,60,0.5), 0 0 60px rgba(139,0,0,0.3);
    letter-spacing: 4px;
    line-height: 1;
  }

  .tagline {
    font-family: 'Share Tech Mono', monospace;
    color: #666;
    font-size: 0.75rem;
    letter-spacing: 3px;
    margin-top: 8px;
    text-transform: uppercase;
  }

  .divider {
    border: none;
    border-top: 1px solid var(--blood);
    margin: 20px 0;
    opacity: 0.4;
    box-shadow: 0 0 10px rgba(139,0,0,0.3);
  }

  /* API KEY SECTION */
  .api-section {
    background: linear-gradient(135deg, #111 0%, #1a0a0a 100%);
    border: 1px solid #2a0a0a;
    border-left: 3px solid var(--blood);
    border-radius: 4px;
    padding: 20px;
    margin-bottom: 24px;
  }

  .section-label {
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.65rem;
    letter-spacing: 3px;
    color: var(--crimson);
    text-transform: uppercase;
    margin-bottom: 10px;
  }

  .api-row {
    display: flex;
    gap: 10px;
    align-items: center;
  }

  input[type="password"], input[type="text"], select, textarea {
    background: #0d0d0d;
    border: 1px solid #2a2a2a;
    color: var(--bone);
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.8rem;
    padding: 10px 14px;
    border-radius: 3px;
    outline: none;
    transition: border-color 0.3s;
    width: 100%;
  }

  input:focus, select:focus, textarea:focus {
    border-color: var(--blood);
    box-shadow: 0 0 10px rgba(139,0,0,0.2);
  }

  .status-dot {
    width: 8px; height: 8px;
    border-radius: 50%;
    background: #333;
    flex-shrink: 0;
    transition: all 0.3s;
  }
  .status-dot.connected { background: #22c55e; box-shadow: 0 0 8px #22c55e; }
  .status-dot.error { background: var(--crimson); box-shadow: 0 0 8px var(--crimson); animation: pulse 1s infinite; }

  @keyframes pulse { 0%,100% { opacity:1; } 50% { opacity:0.4; } }

  /* CONTROLS */
  .controls-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
    margin-bottom: 24px;
  }

  @media (max-width: 600px) { .controls-grid { grid-template-columns: 1fr; } }

  .control-box {
    background: linear-gradient(135deg, #111 0%, #130a0a 100%);
    border: 1px solid #1e1e1e;
    border-radius: 4px;
    padding: 16px;
  }

  select {
    cursor: pointer;
  }

  select option { background: #111; }

  /* GENERATE BUTTON */
  .generate-btn {
    width: 100%;
    padding: 18px;
    background: linear-gradient(135deg, var(--blood) 0%, #5a0010 100%);
    border: 1px solid var(--crimson);
    color: var(--bone);
    font-family: 'Creepster', cursive;
    font-size: 1.4rem;
    letter-spacing: 3px;
    cursor: pointer;
    border-radius: 4px;
    transition: all 0.3s;
    text-transform: uppercase;
    position: relative;
    overflow: hidden;
    margin-bottom: 24px;
  }

  .generate-btn::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, transparent 0%, rgba(220,20,60,0.2) 100%);
    opacity: 0;
    transition: opacity 0.3s;
  }

  .generate-btn:hover::before { opacity: 1; }
  .generate-btn:hover { box-shadow: 0 0 30px rgba(220,20,60,0.4); transform: translateY(-1px); }
  .generate-btn:active { transform: translateY(0); }
  .generate-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

  /* LOADING */
  .loading-bar {
    display: none;
    background: #111;
    border: 1px solid #222;
    border-radius: 3px;
    height: 4px;
    margin-bottom: 24px;
    overflow: hidden;
  }

  .loading-bar.active { display: block; }

  .loading-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--blood), var(--crimson), var(--ember));
    width: 0%;
    transition: width 0.5s ease;
    box-shadow: 0 0 10px var(--crimson);
  }

  .loading-text {
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.7rem;
    color: #666;
    text-align: center;
    margin-bottom: 16px;
    display: none;
    letter-spacing: 2px;
  }
  .loading-text.active { display: block; }

  /* OUTPUT SECTIONS */
  .output-section {
    display: none;
    animation: fadeIn 0.6s ease;
  }

  .output-section.visible { display: block; }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .output-card {
    background: linear-gradient(135deg, #0f0f0f 0%, #120808 100%);
    border: 1px solid #1e1212;
    border-radius: 4px;
    margin-bottom: 16px;
    overflow: hidden;
  }

  .card-header {
    background: linear-gradient(90deg, #1a0808 0%, #110505 100%);
    border-bottom: 1px solid #2a1010;
    padding: 12px 16px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .card-title {
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.7rem;
    letter-spacing: 2px;
    color: var(--crimson);
    text-transform: uppercase;
  }

  .copy-btn {
    background: transparent;
    border: 1px solid #333;
    color: #888;
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.6rem;
    padding: 4px 10px;
    cursor: pointer;
    border-radius: 2px;
    letter-spacing: 1px;
    transition: all 0.2s;
    text-transform: uppercase;
  }

  .copy-btn:hover { border-color: var(--crimson); color: var(--crimson); }
  .copy-btn.copied { border-color: #22c55e; color: #22c55e; }

  .card-body {
    padding: 16px;
    font-size: 0.9rem;
    line-height: 1.7;
    color: #ccc;
    white-space: pre-wrap;
    font-family: 'Special Elite', cursive;
  }

  .card-body.mono {
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.8rem;
    color: #aaa;
  }

  /* TAGS */
  .tags-container {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    padding: 16px;
  }

  .tag {
    background: #1a0a0a;
    border: 1px solid #2a1010;
    color: #888;
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.65rem;
    padding: 4px 10px;
    border-radius: 2px;
    letter-spacing: 1px;
  }

  /* STEPS */
  .steps-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 12px;
    padding: 16px;
  }

  .step-item {
    background: #0d0d0d;
    border: 1px solid #1e1e1e;
    border-radius: 3px;
    padding: 12px;
  }

  .step-num {
    font-family: 'Creepster', cursive;
    font-size: 1.5rem;
    color: var(--blood);
    display: block;
    margin-bottom: 4px;
  }

  .step-title {
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.65rem;
    color: var(--crimson);
    letter-spacing: 1px;
    text-transform: uppercase;
    display: block;
    margin-bottom: 6px;
  }

  .step-desc {
    font-size: 0.75rem;
    color: #777;
    line-height: 1.5;
  }

  /* SCORE BARS */
  .score-row {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 10px;
    padding: 0 16px;
  }

  .score-label {
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.65rem;
    color: #666;
    width: 120px;
    flex-shrink: 0;
    letter-spacing: 1px;
    text-transform: uppercase;
  }

  .score-bar {
    flex: 1;
    height: 6px;
    background: #1a1a1a;
    border-radius: 3px;
    overflow: hidden;
  }

  .score-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--blood), var(--crimson));
    border-radius: 3px;
    box-shadow: 0 0 6px var(--crimson);
    transition: width 1s ease;
    width: 0%;
  }

  .score-val {
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.7rem;
    color: var(--crimson);
    width: 30px;
    text-align: right;
  }

  /* RESET */
  .reset-btn {
    width: 100%;
    padding: 12px;
    background: transparent;
    border: 1px solid #2a2a2a;
    color: #555;
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.7rem;
    letter-spacing: 2px;
    cursor: pointer;
    border-radius: 3px;
    margin-top: 8px;
    transition: all 0.3s;
    text-transform: uppercase;
  }
  .reset-btn:hover { border-color: #555; color: #999; }

  /* FOOTER */
  footer {
    text-align: center;
    padding: 30px 0;
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.6rem;
    color: #333;
    letter-spacing: 2px;
    text-transform: uppercase;
  }

  .error-msg {
    background: #1a0000;
    border: 1px solid var(--blood);
    color: #ff6b6b;
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.75rem;
    padding: 12px 16px;
    border-radius: 3px;
    margin-bottom: 16px;
    display: none;
    letter-spacing: 1px;
  }
  .error-msg.visible { display: block; }
</style>
</head>
<body>
<div class="noise"></div>

<div class="container">
  <header>
    <span class="skull">üíÄ</span>
    <h1>NIGHTMARE FACTORY</h1>
    <p class="tagline">YouTube Horror Automation Dashboard</p>
  </header>
  <hr class="divider">

  <!-- API KEY -->
  <div class="api-section">
    <div class="section-label">‚ö° Groq API Key</div>
    <div class="api-row">
      <div class="status-dot" id="statusDot"></div>
      <input type="password" id="apiKey" placeholder="gsk_..." />
      <button class="copy-btn" onclick="testKey()" style="white-space:nowrap;padding:10px 16px;">Test Key</button>
    </div>
    <div style="font-family:'Share Tech Mono',monospace;font-size:0.6rem;color:#444;margin-top:8px;letter-spacing:1px;">
      Get free key at console.groq.com ‚Üí API Keys ‚Üí Create API Key
    </div>
  </div>

  <!-- CONTROLS -->
  <div class="controls-grid">
    <div class="control-box">
      <div class="section-label">ü©∏ Story Type</div>
      <select id="storyType">
        <option value="supernatural">üëª Supernatural / Ghost</option>
        <option value="psychological">üß† Psychological Horror</option>
        <option value="creature">üêç Creature / Monster</option>
        <option value="urban_legend">üåÜ Urban Legend</option>
        <option value="true_horror">üì∞ True Crime Horror</option>
        <option value="sleep_paralysis">üò¥ Sleep Paralysis</option>
        <option value="woods">üå≤ Deep Woods Horror</option>
        <option value="online">üíª Internet / Online Horror</option>
      </select>
    </div>
    <div class="control-box">
      <div class="section-label">‚è± Video Length</div>
      <select id="videoLength">
        <option value="short">Short (3-5 min) ‚Äî Shorts friendly</option>
        <option value="medium" selected>Medium (8-12 min) ‚Äî Best for ads</option>
        <option value="long">Long (15-20 min) ‚Äî Max watch time</option>
      </select>
    </div>
    <div class="control-box">
      <div class="section-label">üé≠ Tone</div>
      <select id="tone">
        <option value="slow_burn">Slow Burn & Dread</option>
        <option value="shocking">Shocking & Intense</option>
        <option value="atmospheric">Dark & Atmospheric</option>
        <option value="twist">Twist Ending</option>
      </select>
    </div>
    <div class="control-box">
      <div class="section-label">üåç Setting</div>
      <select id="setting">
        <option value="random">üé≤ Random (Recommended)</option>
        <option value="abandoned">Abandoned Building</option>
        <option value="rural">Rural Countryside</option>
        <option value="suburban">Suburban Neighborhood</option>
        <option value="forest">Dark Forest</option>
        <option value="online">The Internet</option>
        <option value="hospital">Hospital / Asylum</option>
      </select>
    </div>
  </div>

  <!-- GENERATE -->
  <button class="generate-btn" id="generateBtn" onclick="generateVideo()">
    ‚ò† GENERATE HORROR VIDEO PACKAGE ‚ò†
  </button>

  <!-- LOADING -->
  <div class="loading-bar" id="loadingBar"><div class="loading-fill" id="loadingFill"></div></div>
  <div class="loading-text" id="loadingText">SUMMONING DARKNESS...</div>

  <!-- ERROR -->
  <div class="error-msg" id="errorMsg"></div>

  <!-- OUTPUT -->
  <div class="output-section" id="outputSection">

    <!-- TITLE & HOOK -->
    <div class="output-card">
      <div class="card-header">
        <span class="card-title">üé¨ YouTube Title & Hook</span>
        <button class="copy-btn" onclick="copySection('titleContent')">Copy</button>
      </div>
      <div class="card-body" id="titleContent"></div>
    </div>

    <!-- FULL SCRIPT -->
    <div class="output-card">
      <div class="card-header">
        <span class="card-title">üìú Full Video Script (Narration)</span>
        <button class="copy-btn" onclick="copySection('scriptContent')">Copy</button>
      </div>
      <div class="card-body" id="scriptContent"></div>
    </div>

    <!-- IMAGE PROMPTS -->
    <div class="output-card">
      <div class="card-header">
        <span class="card-title">üé® AI Image Prompts (for Leonardo.ai)</span>
        <button class="copy-btn" onclick="copySection('imageContent')">Copy</button>
      </div>
      <div class="card-body mono" id="imageContent"></div>
    </div>

    <!-- MUSIC -->
    <div class="output-card">
      <div class="card-header">
        <span class="card-title">üéµ Music Prompts (for Suno.ai)</span>
        <button class="copy-btn" onclick="copySection('musicContent')">Copy</button>
      </div>
      <div class="card-body mono" id="musicContent"></div>
    </div>

    <!-- YOUTUBE META -->
    <div class="output-card">
      <div class="card-header">
        <span class="card-title">üìã YouTube Description</span>
        <button class="copy-btn" onclick="copySection('descContent')">Copy</button>
      </div>
      <div class="card-body" id="descContent"></div>
    </div>

    <!-- TAGS -->
    <div class="output-card">
      <div class="card-header">
        <span class="card-title">üè∑ YouTube Tags</span>
        <button class="copy-btn" onclick="copySection('tagsContent')">Copy</button>
      </div>
      <div class="tags-container" id="tagsContent"></div>
    </div>

    <!-- THUMBNAIL -->
    <div class="output-card">
      <div class="card-header">
        <span class="card-title">üñº Thumbnail Brief (for Canva)</span>
        <button class="copy-btn" onclick="copySection('thumbContent')">Copy</button>
      </div>
      <div class="card-body mono" id="thumbContent"></div>
    </div>

    <!-- VIRAL SCORE -->
    <div class="output-card">
      <div class="card-header">
        <span class="card-title">üìà Viral Potential Score</span>
      </div>
      <div style="padding:16px 0 8px;">
        <div class="score-row">
          <span class="score-label">Hook Strength</span>
          <div class="score-bar"><div class="score-fill" id="score1"></div></div>
          <span class="score-val" id="scoreVal1"></span>
        </div>
        <div class="score-row">
          <span class="score-label">Watch Time</span>
          <div class="score-bar"><div class="score-fill" id="score2"></div></div>
          <span class="score-val" id="scoreVal2"></span>
        </div>
        <div class="score-row">
          <span class="score-label">Click-Through</span>
          <div class="score-bar"><div class="score-fill" id="score3"></div></div>
          <span class="score-val" id="scoreVal3"></span>
        </div>
        <div class="score-row">
          <span class="score-label">SEO Potential</span>
          <div class="score-bar"><div class="score-fill" id="score4"></div></div>
          <span class="score-val" id="scoreVal4"></span>
        </div>
      </div>
    </div>

    <!-- PRODUCTION STEPS -->
    <div class="output-card">
      <div class="card-header">
        <span class="card-title">üõ† Your Production Checklist</span>
      </div>
      <div class="steps-grid">
        <div class="step-item"><span class="step-num">01</span><span class="step-title">Script ‚úÖ</span><span class="step-desc">Copy narration script above ‚Äî done!</span></div>
        <div class="step-item"><span class="step-num">02</span><span class="step-title">Voiceover</span><span class="step-desc">Go to ttsmp3.com ‚Üí paste script ‚Üí download MP3</span></div>
        <div class="step-item"><span class="step-num">03</span><span class="step-title">Images</span><span class="step-desc">Go to leonardo.ai ‚Üí paste image prompts above ‚Üí download</span></div>
        <div class="step-item"><span class="step-num">04</span><span class="step-title">Music</span><span class="step-desc">Go to suno.ai ‚Üí paste music prompt ‚Üí download MP3</span></div>
        <div class="step-item"><span class="step-num">05</span><span class="step-title">Assemble</span><span class="step-desc">Open CapCut ‚Üí import images + voice + music ‚Üí add auto captions</span></div>
        <div class="step-item"><span class="step-num">06</span><span class="step-title">Thumbnail</span><span class="step-desc">Open Canva ‚Üí use thumbnail brief above ‚Üí download PNG</span></div>
        <div class="step-item"><span class="step-num">07</span><span class="step-title">Upload</span><span class="step-desc">YouTube Studio ‚Üí paste title, description & tags above ‚Üí publish!</span></div>
      </div>
    </div>

    <button class="reset-btn" onclick="resetDashboard()">‚Ü∫ Generate Another Video</button>
  </div>

  <footer>nightmare factory v1.0 ¬∑ built for your horror empire ¬∑ start posting ¬∑ get monetized</footer>
</div>

<script>
let apiKeyValue = '';

async function testKey() {
  const key = document.getElementById('apiKey').value.trim();
  if (!key) { showError('Please enter your Groq API key first!'); return; }
  apiKeyValue = key;
  const dot = document.getElementById('statusDot');
  dot.style.background = '#f59e0b';
  dot.style.boxShadow = '0 0 8px #f59e0b';
  showError('');

  try {
    const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${key}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        model: 'llama-3.3-70b-versatile',
        max_tokens: 10,
        messages: [{ role: 'user', content: 'Say OK' }]
      })
    });
    if (response.ok) {
      dot.className = 'status-dot connected';
      showError('‚úÖ Groq key connected! You are ready to generate videos.');
    } else {
      const err = await response.json();
      dot.className = 'status-dot error';
      showError('‚ùå Invalid key: ' + (err.error?.message || 'Check your key and try again.'));
    }
  } catch(e) {
    if (key.startsWith('gsk_')) {
      dot.className = 'status-dot connected';
      showError('‚úÖ Key format looks valid! Try generating a video.');
    } else {
      dot.className = 'status-dot error';
      showError('‚ùå Key does not look right. It should start with gsk_...');
    }
  }
}

function showError(msg) {
  const el = document.getElementById('errorMsg');
  el.textContent = msg;
  el.className = msg ? 'error-msg visible' : 'error-msg';
}

function setLoading(pct, msg) {
  document.getElementById('loadingBar').className = 'loading-bar active';
  document.getElementById('loadingText').className = 'loading-text active';
  document.getElementById('loadingFill').style.width = pct + '%';
  document.getElementById('loadingText').textContent = msg;
}

function resetDashboard() {
  document.getElementById('outputSection').className = 'output-section';
  document.getElementById('loadingBar').className = 'loading-bar';
  document.getElementById('loadingText').className = 'loading-text';
  document.getElementById('generateBtn').disabled = false;
  document.getElementById('generateBtn').textContent = '‚ò† GENERATE HORROR VIDEO PACKAGE ‚ò†';
  window.scrollTo({top: 0, behavior: 'smooth'});
}

async function generateVideo() {
  const key = document.getElementById('apiKey').value.trim();
  if (!key) { showError('‚ö† Enter your Groq API key first!'); return; }
  apiKeyValue = key;

  const storyType = document.getElementById('storyType').value;
  const videoLength = document.getElementById('videoLength').value;
  const tone = document.getElementById('tone').value;
  const setting = document.getElementById('setting').value;

  const lengthMap = { short: '400-600 words', medium: '800-1200 words', long: '1500-2000 words' };
  const wordCount = lengthMap[videoLength];

  document.getElementById('generateBtn').disabled = true;
  document.getElementById('generateBtn').textContent = '‚ò† SUMMONING...';
  showError('');
  setLoading(10, 'OPENING THE DARKNESS...');

  const prompt = `You are a viral YouTube horror content creator. Generate a complete video package for a horror YouTube channel. Return ONLY valid JSON, no markdown, no extra text.

Story type: ${storyType}
Tone: ${tone}  
Setting: ${setting === 'random' ? 'choose a compelling random setting' : setting}
Script length: ${wordCount}

Return this exact JSON structure:
{
  "title": "YouTube video title (scary, clickbait, max 60 chars, use numbers or 'I' perspective)",
  "hook": "First 2 sentences of the video - must make viewer unable to stop watching",
  "script": "Full narration script for the video (${wordCount}). Start with the hook. Write in first person. Include [PAUSE] markers for dramatic effect. Make it genuinely scary with vivid descriptions.",
  "imagePrompts": [
    "Detailed image generation prompt 1 for opening scene (dark, cinematic, horror style)",
    "Detailed image generation prompt 2 for middle scene",
    "Detailed image generation prompt 3 for climax scene",
    "Detailed image generation prompt 4 for ending scene",
    "Detailed image generation prompt 5 for atmosphere shot"
  ],
  "musicPrompt": "Suno.ai music generation prompt for background horror music (no lyrics, atmospheric)",
  "description": "YouTube video description (150-200 words, SEO optimized, include keywords, add chapters if medium/long)",
  "tags": ["tag1", "tag2", "tag3", "tag4", "tag5", "tag6", "tag7", "tag8", "tag9", "tag10", "tag11", "tag12", "tag13", "tag14", "tag15"],
  "thumbnailBrief": "Detailed Canva thumbnail design brief: background color, text to display, image description, font style, color scheme",
  "scores": {
    "hook": 85,
    "watchTime": 80,
    "clickThrough": 88,
    "seo": 75
  }
}`;

  try {
    setLoading(30, 'WRITING YOUR HORROR STORY...');

    const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${key}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        model: 'llama-3.3-70b-versatile',
        max_tokens: 4000,
        temperature: 0.9,
        messages: [{ role: 'user', content: prompt }]
      })
    });

    setLoading(70, 'CRAFTING YOUR VIDEO PACKAGE...');

    if (!response.ok) {
      const err = await response.json();
      throw new Error(err.error?.message || 'Groq API request failed');
    }

    const data = await response.json();
    const raw = data.choices?.[0]?.message?.content;
    if (!raw) throw new Error('No response from Groq. Try again!');

    setLoading(90, 'ASSEMBLING THE NIGHTMARE...');

    // Parse JSON
    let result;
    try {
      const clean = raw.replace(/```json\n?/g,'').replace(/```\n?/g,'').trim();
      result = JSON.parse(clean);
    } catch(e) {
      // Try to extract JSON from response
      const match = raw.match(/\{[\s\S]*\}/);
      if (match) result = JSON.parse(match[0]);
      else throw new Error('Could not parse AI response. Try again!');
    }

    setLoading(100, 'COMPLETE.');
    setTimeout(() => renderOutput(result), 400);

  } catch(err) {
    document.getElementById('loadingBar').className = 'loading-bar';
    document.getElementById('loadingText').className = 'loading-text';
    document.getElementById('generateBtn').disabled = false;
    document.getElementById('generateBtn').textContent = '‚ò† GENERATE HORROR VIDEO PACKAGE ‚ò†';
    showError('Error: ' + err.message + ' ‚Äî Check your API key or try again.');
  }
}

function renderOutput(data) {
  // Title & Hook
  document.getElementById('titleContent').textContent = 
    `TITLE:\n${data.title}\n\nHOOK (First words of your video):\n${data.hook}`;

  // Script
  document.getElementById('scriptContent').textContent = data.script;

  // Image prompts
  const imgText = data.imagePrompts.map((p, i) => 
    `SCENE ${i+1}:\n${p}\n`
  ).join('\n');
  document.getElementById('imageContent').textContent = 
    imgText + '\n‚Üí Go to leonardo.ai ‚Üí paste each prompt ‚Üí download images';

  // Music
  document.getElementById('musicContent').textContent = 
    `MUSIC PROMPT FOR SUNO.AI:\n${data.musicPrompt}\n\n‚Üí Go to suno.ai ‚Üí paste prompt ‚Üí download MP3`;

  // Description
  document.getElementById('descContent').textContent = data.description;

  // Tags
  const tagsContainer = document.getElementById('tagsContent');
  tagsContainer.innerHTML = '';
  if (data.tags && Array.isArray(data.tags)) {
    data.tags.forEach(tag => {
      const el = document.createElement('span');
      el.className = 'tag';
      el.textContent = tag;
      tagsContainer.appendChild(el);
    });
  }

  // Thumbnail
  document.getElementById('thumbContent').textContent = 
    `THUMBNAIL DESIGN BRIEF FOR CANVA:\n${data.thumbnailBrief}\n\n‚Üí Go to canva.com ‚Üí YouTube Thumbnail ‚Üí customize based on brief above`;

  // Scores
  if (data.scores) {
    const scores = [
      { id: 1, val: data.scores.hook || 80 },
      { id: 2, val: data.scores.watchTime || 78 },
      { id: 3, val: data.scores.clickThrough || 85 },
      { id: 4, val: data.scores.seo || 72 }
    ];
    setTimeout(() => {
      scores.forEach(s => {
        document.getElementById(`score${s.id}`).style.width = s.val + '%';
        document.getElementById(`scoreVal${s.id}`).textContent = s.val + '%';
      });
    }, 300);
  }

  // Show output
  document.getElementById('outputSection').className = 'output-section visible';
  document.getElementById('loadingBar').className = 'loading-bar';
  document.getElementById('loadingText').className = 'loading-text';
  document.getElementById('generateBtn').textContent = '‚ò† GENERATE HORROR VIDEO PACKAGE ‚ò†';

  // Scroll to output
  setTimeout(() => {
    document.getElementById('outputSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
  }, 200);
}

function copySection(id) {
  const el = document.getElementById(id);
  let text = '';
  
  if (id === 'tagsContent') {
    const tags = el.querySelectorAll('.tag');
    text = Array.from(tags).map(t => t.textContent).join(', ');
  } else {
    text = el.textContent;
  }
  
  navigator.clipboard.writeText(text).then(() => {
    const btn = el.closest('.output-card').querySelector('.copy-btn');
    btn.textContent = 'Copied!';
    btn.className = 'copy-btn copied';
    setTimeout(() => {
      btn.textContent = 'Copy';
      btn.className = 'copy-btn';
    }, 2000);
  });
}
</script>
</body>
</html>
